# สรุประบบบริหารจัดการปั๊ม (Gas Station Management System - M1)

## ภาพรวมระบบ

ระบบบริหารจัดการปั๊ม (M1) เป็นระบบจัดการปั๊มน้ำมันที่ครอบคลุมการจัดการยอดขาย สต็อก การซื้อเข้า การปรับราคา และรายงานต่างๆ สำหรับ 5 ปั๊ม (1 สำนักงานใหญ่ + 4 สาขา) ข้อมูลนำเข้าจาก PTT BackOffice (Excel)

---

## ฟังก์ชันหลักทั้งหมด

### 1. Dashboard (หน้าหลัก)

**หน้าที่:** แสดงภาพรวมข้อมูลปั๊มทั้งหมดแบบเรียลไทม์

**ข้อมูลที่แสดง:**
- ยอดขายวันนี้ (เปรียบเทียบกับเมื่อวาน)
- ยอดขายรวมเดือนนี้ (เปรียบเทียบกับเดือนที่แล้ว)
- กำไรสุทธิวันนี้
- จำนวนถังที่สต็อกใกล้หมด
- ระบบคูปองสถานี (ยอดขายด้วยคูปอง, จำนวนคูปองที่ใช้, สถานะ)
- ยอดขายแยกตามช่องทางชำระเงิน (เงินสด, QR/KPLUS/PROMPTPAY, Master/VISA, คูปองสถานี, อื่นๆ)
- สต็อกน้ำมัน (รายการถังทั้งหมด พร้อมสถานะใกล้หมด)
- สรุปการเงินวันนี้ (รายรับ, ต้นทุน, กำไรขั้นต้น, รายจ่าย, กำไรสุทธิ)
- ยอดขายแยกตามสาขา (5 สาขา)
- การซื้อน้ำมันเข้า (ประวัติการซื้อล่าสุด)

**Flow การทำงาน:**
1. ระบบดึงข้อมูลจาก Sales, Stock, Purchases, Coupons
2. คำนวณสถิติแบบ Real-time
3. แสดงข้อมูลในรูปแบบ Dashboard Cards, Charts และ Tables
4. รองรับการนำเข้า Excel จาก PTT BackOffice

---

### 2. ซื้อเข้าน้ำมัน (Purchases)

**หน้าที่:** จัดการการซื้อเข้าน้ำมันแยกตามชนิดน้ำมัน 8 ชนิด

**ข้อมูลที่เก็บ:**
- วันที่ซื้อ
- ชนิดน้ำมัน (Premium Diesel, Premium Gasohol 95, Diesel, E85, E20, Gasohol 91, Gasohol 95)
- ปริมาณ (ลิตร)
- จำนวนเงิน (บาท)
- สาขา (สำนักงานใหญ่, สาขา A, สาขา B, สาขา C, สาขา D)
- แหล่งที่มา (Manual, PURCHASE_YYYYMMDD.xlsx)
- สถานะ (บันทึกแล้ว)

**ฟังก์ชัน:**
- บันทึกการซื้อเข้าน้ำมัน (กรอกด้วยมือ)
- นำเข้า Excel จาก PTT BackOffice (PURCHASE_YYYYMMDD.xlsx)
- ระบบสร้างใบรับสินค้าอัตโนมัติจากข้อมูล Excel
- กรองข้อมูลตามชนิดน้ำมัน, สาขา
- ค้นหาข้อมูล
- สรุปสถิติ (รายการทั้งหมด, ปริมาณรวม, ยอดรวม, จำนวนที่มาจาก Excel)

**Flow การทำงาน:**
1. นำเข้า Excel จาก PTT BackOffice หรือกรอกด้วยมือ
2. ระบบประมวลผลและสร้างใบรับสินค้าอัตโนมัติ
3. บันทึกข้อมูลการซื้อเข้า
4. อัปเดตสต็อกน้ำมันอัตโนมัติ

---

### 3. ยอดขาย (Sales)

**หน้าที่:** ประมวลผลยอดขายแยกตามช่องทางชำระเงิน 12 ช่องทาง

**ข้อมูลที่เก็บ:**
- วันที่ขาย
- ชนิดน้ำมัน
- ปริมาณ (ลิตร)
- จำนวนเงิน (บาท)
- ช่องทางชำระเงิน (เงินสด, Master/VISA, KBANK-CARD, PTT Privilege Energy Card, Fleet Card, Top up Card, ttb Fill&GO+, BBL Fleet Card, Visa Local Card, QR/KPLUS/PROMPTPAY, คูปองสถานี, ลูกหนี้เงินเชื่อ)
- สาขา
- แหล่งที่มา (SALES_YYYYMMDD.xlsx)
- รหัสคูปอง (ถ้าใช้คูปองสถานี)

**ฟังก์ชัน:**
- นำเข้า Excel จาก PTT BackOffice (SALES_YYYYMMDD.xlsx)
- แสดงยอดขายแยกตามช่องทางชำระเงิน
- สรุปยอดขายด้วยคูปองสถานี (ยอดขายเต็มราคา - ไม่หักส่วนลด)
- กรองข้อมูลตามวันที่, ช่องทางชำระ, สาขา
- ค้นหาข้อมูล
- สรุปสถิติ (ยอดขายวันนี้, ยอดขายเดือนนี้, รายการทั้งหมด, จำนวนช่องทางชำระ)

**Flow การทำงาน:**
1. นำเข้า Excel จาก PTT BackOffice
2. ระบบประมวลผลยอดขายแยกตามช่องทางชำระเงิน 12 ช่องทาง
3. คำนวณยอดขายรวมและแยกตามช่องทาง
4. แสดงข้อมูลในรูปแบบ Cards และ Lists

**หมายเหตุ:** คูปองสถานีใน M1 เป็นช่องทางการชำระเงินเท่านั้น (PaymentType = Coupon) ไม่มีการหักส่วนลด ยอดขายยังคงเต็มราคา (Full Price) ตามข้อมูลจาก PTT BackOffice

---

### 4. ระบบคูปองสถานี (Coupons)

**หน้าที่:** จัดการสมาชิก คูปองสมาชิก และคูปองสถานี

**ข้อมูลที่เก็บ:**

**สมาชิก:**
- รหัสสมาชิก
- ชื่อ-นามสกุล
- เบอร์โทร
- อีเมล
- วันที่สมัคร
- สถานะ (ใช้งาน, ไม่ใช้งาน)

**คูปองสมาชิก:**
- รหัสคูปอง
- สมาชิก (ID, ชื่อ)
- วันที่ออก
- วันหมดอายุ
- ชนิดน้ำมัน (ไม่บังคับ - คูปองใช้ได้กับทุกน้ำมัน)
- ปริมาณ (ลิตร)
- ยอดรวมทั้งหมด (บาท)
- ยอดที่ใช้ไปแล้ว (บาท)
- สาขา
- สถานะ (ใช้งาน, ใช้แล้ว, หมดอายุ)
- วันที่ใช้ (ถ้าใช้แล้ว)
- จำนวนครั้งที่ต่ออายุ

**ประวัติการใช้คูปอง:**
- วันที่ใช้
- รหัสคูปอง
- สมาชิก
- ชนิดน้ำมันที่ใช้จริง
- ปริมาณที่เติม (ลิตร)
- ยอดที่ใช้ (บาท)
- สาขา

**ฟังก์ชัน:**
- เพิ่มสมาชิก
- เพิ่มคูปองให้สมาชิก
- ใช้คูปอง (สามารถใช้บางส่วนได้)
- ต่ออายุคูปอง (เพิ่มอายุ 1 เดือน)
- ดูคูปองใกล้หมดอายุ (เหลือไม่เกิน 7 วัน)
- ดูประวัติการใช้คูปอง
- กรองและค้นหาข้อมูล

**Flow การทำงาน:**
1. เพิ่มสมาชิก → ออกคูปองให้สมาชิก
2. เมื่อใช้คูปอง → บันทึกยอดที่ใช้ → อัปเดตยอดคงเหลือ
3. ถ้าใช้หมดแล้ว → เปลี่ยนสถานะเป็น "ใช้แล้ว"
4. ถ้าคูปองใกล้หมดอายุ → แสดงในแท็บ "คูปองใกล้หมดอายุ"
5. สามารถต่ออายุคูปองได้ (เพิ่มอายุ 1 เดือน)

---

### 5. สต็อกน้ำมัน (Stock)

**หน้าที่:** ติดตามสต็อกน้ำมันทุกถัง แยกตามปั๊มและชนิด

**ข้อมูลที่เก็บ:**
- ชนิดน้ำมัน
- ปริมาณคงเหลือ (ลิตร)
- ถัง (รหัสถัง)
- สาขา
- สถานะ (ปกติ, ใกล้หมด)

**ฟังก์ชัน:**
- นำเข้า Excel จาก PTT BackOffice (STOCK_YYYYMMDD.xlsx)
- แสดงสต็อกทั้งหมดแยกตามถัง
- กรองข้อมูลตามสาขา
- ค้นหาข้อมูล
- สรุปสถิติ (สต็อกรวม, Diesel, Gasohol 95, จำนวนถังที่ใกล้หมด)

**Flow การทำงาน:**
1. นำเข้า Excel จาก PTT BackOffice
2. ระบบอัปเดตสต็อกน้ำมันทุกถัง
3. ตรวจสอบและแจ้งเตือนถ้าสต็อกต่ำ

---

### 6. แจ้งเตือนสต็อก (Stock Alerts)

**หน้าที่:** ตั้งระดับต่ำสุดและแจ้งเตือนเมื่อสต็อกต่ำ

**ข้อมูลที่เก็บ:**
- ระดับต่ำสุด (Warning) - ลิตร
- ระดับวิกฤต (Critical) - ลิตร
- ช่องทางแจ้งเตือน (Email, Line, SMS)
- ความถี่ในการแจ้งเตือน (Real-time)

**ฟังก์ชัน:**
- ตั้งค่าระดับต่ำสุด (Warning และ Critical)
- เลือกช่องทางแจ้งเตือน (Email, Line, SMS)
- แสดงแจ้งเตือนที่ยังไม่แก้ไข
- แยกแจ้งเตือนตามระดับ (Warning, Critical)

**Flow การทำงาน:**
1. ตั้งค่าระดับต่ำสุดและช่องทางแจ้งเตือน
2. ระบบตรวจสอบสต็อกทุกถัง
3. ถ้าสต็อกต่ำกว่าระดับที่ตั้งไว้ → แจ้งเตือนผ่านช่องทางที่เลือก
4. แสดงรายการแจ้งเตือนที่ยังไม่แก้ไข

---

### 7. Meter & Dip Reading

**หน้าที่:** บันทึกมิเตอร์หัวจ่าย + Dip ถังทุกวัน และคำนวณ Loss/Gain อัตโนมัติ

**ข้อมูลที่เก็บ:**
- วันที่
- สาขา
- ถัง (รหัสถัง)
- ชนิดน้ำมัน
- มิเตอร์หัวจ่าย (ลิตร) - ค่าปัจจุบันและค่าก่อนหน้า
- Dip ถัง (ลิตร) - ค่าปัจจุบันและค่าก่อนหน้า
- ยอดขาย (ลิตร) - คำนวณจาก มิเตอร์ - Dip
- Loss/Gain (ลิตร) - คำนวณอัตโนมัติ
- Loss/Gain (%) - คำนวณอัตโนมัติ
- สถานะ (ปกติ, เตือน, ผิดปกติ)

**ฟังก์ชัน:**
- บันทึก Meter/Dip ทุกวัน
- คำนวณยอดขายอัตโนมัติ (มิเตอร์ - Dip)
- คำนวณ Loss/Gain อัตโนมัติ
- แจ้งเตือนถ้า Loss/Gain เกิน 0.5%
- กรองข้อมูลตามวันที่, สาขา
- สรุปสถิติ (ถังทั้งหมด, Loss/Gain รวม, ยอดขายรวม, จำนวนถังที่เตือน)

**Flow การทำงาน:**
1. บันทึกมิเตอร์หัวจ่ายและ Dip ถังทุกวัน
2. ระบบคำนวณยอดขาย = มิเตอร์ปัจจุบัน - มิเตอร์ก่อนหน้า
3. ระบบคำนวณ Loss/Gain = ยอดขาย - (Dip ก่อนหน้า - Dip ปัจจุบัน)
4. ถ้า Loss/Gain เกิน 0.5% → แจ้งเตือน (อาจเกิดจากรั่วไหล, ระเหย, ความคลาดเคลื่อน)

---

### 8. Balance Petrel / Dip Reading

**หน้าที่:** ประมวลผลสมุดน้ำมันใต้ดิน (Dip Reading) และสมุด Balance Petrel เปรียบเทียบ Dip vs ขายจริง → แจ้งเตือน Diff

**ข้อมูลที่เก็บ:**

**สมุด Balance Petrel:**
- รายการข้อมูลหลายคอลัมน์ (ส่วนซ้าย: col1, col2, col3, col4, Diff, ส่วนขวา: col1A, col1B, col1C, col1D, col1E, col1F)
- Diff (ความแตกต่าง) - แสดงเป็น + หรือ -

**สมุดน้ำมันใต้ดิน (Dip Reading):**
- รายการข้อมูลหลายคอลัมน์ (ส่วนซ้าย: วัน/เดือน/ปี, -, ค่า, รวม, +, ค่า, ค่า, ส่วนขวา: 1B, 1C, 1D, 1E, 1F)
- แต่ละส่วนมีหลายคอลัมน์ย่อย

**ฟังก์ชัน:**
- นำเข้า Excel จาก PTT BackOffice (BALANCE_YYYYMMDD.xlsx, DIP_YYYYMMDD.xlsx)
- แสดงข้อมูล Balance Petrel และ Dip Reading แยกกัน
- เปรียบเทียบ Dip vs ขายจริง → แจ้งเตือน Diff
- กรองข้อมูลตามสาขา, สถานะ
- ค้นหาข้อมูล
- สรุปสถิติ (รายการทั้งหมด, จำนวนรายการที่แจ้งเตือน Diff, สถานะปกติ)

**Flow การทำงาน:**
1. นำเข้า Excel จาก PTT BackOffice (Balance Petrel และ Dip Reading)
2. ระบบเปรียบเทียบ Dip Reading vs ขายจริง
3. คำนวณ Diff (ความแตกต่าง)
4. ถ้า Diff เกินเกณฑ์ที่กำหนด → แจ้งเตือน (ป้องกันการรั่วไหล)

---

### 9. ปรับราคา (Price Management)

**หน้าที่:** ปรับราคาขายปลีกอัตโนมัติ (PTT แจ้งราคาใหม่ตอน 18:00 → พนักงานปรับราคาในระบบ → ราคาเปลี่ยนอัตโนมัติตอน 05:00)

**ข้อมูลที่เก็บ:**
- ชนิดน้ำมัน
- ราคาปัจจุบัน (บาท/ลิตร)
- ราคาก่อนหน้า (บาท/ลิตร)
- ราคาใหม่ (บาท/ลิตร) - รอการตั้งเวลา
- ราคาที่ตั้งเวลาไว้ (บาท/ลิตร) - จะเปลี่ยนอัตโนมัติ
- สถานะ (ใช้งาน, รอการปรับราคา, ตั้งเวลาแล้ว)
- เวลาที่จะเปลี่ยนราคา (05:00)

**ประวัติการปรับราคา:**
- วันที่/เวลา
- ชนิดน้ำมัน
- ราคาเก่า
- ราคาใหม่
- เปลี่ยนแปลง (บาท, %)
- ผู้ปรับ (ระบบอัตโนมัติ, พนักงาน, ตั้งเวลา)
- ประเภท (อัตโนมัติ, ตั้งเวลา, ปรับเอง)

**ฟังก์ชัน:**
- บันทึกการแจ้งราคาจาก PTT (ตอน 18:00)
- กรอกราคาใหม่สำหรับแต่ละชนิดน้ำมัน
- ตั้งเวลาเปลี่ยนราคา (จะเปลี่ยนอัตโนมัติตอน 05:00)
- เปลี่ยนราคาทันที (ถ้าต้องการ)
- ยกเลิกการตั้งเวลา
- ดูประวัติการปรับราคา
- ตั้งค่าการเปลี่ยนราคาอัตโนมัติ (เปิด/ปิด, เวลาที่จะเปลี่ยน)

**Flow การทำงาน:**
1. PTT โทมาแจ้งราคาใหม่ตอน 18:00 → กดปุ่ม "บันทึกการแจ้งจาก PTT"
2. พนักงานกรอกราคาใหม่สำหรับแต่ละชนิดน้ำมัน
3. กดปุ่ม "ตั้งเวลาเปลี่ยน" เพื่อตั้งให้ราคาเปลี่ยนอัตโนมัติตอน 05:00
4. ระบบจะเปลี่ยนราคาอัตโนมัติเมื่อถึงเวลา 05:00 และบันทึกประวัติอัตโนมัติ

---

### 10. สั่งซื้อน้ำมัน (Requisitions)

**หน้าที่:** ระบบสั่งซื้อน้ำมันแบบรวมศูนย์ (Centralized Oil Ordering) - รวบรวมคำขอจาก 5 สาขา → สั่งซื้อแบบ Bulk (ประหยัดต้นทุน) → จัดส่ง → กระจายต้นทุน

**ข้อมูลที่เก็บ:**

**คำขอจากสาขา (Branch Requests):**
- สาขา
- วันที่ส่งคำขอ
- เวลาส่ง
- ปริมาณที่ต้องการ (Diesel, Gasohol 95, E20, Gasohol 91) - ลิตร
- สถานะ (รอสั่งซื้อ, รวมยอดแล้ว)

**ใบสั่งซื้อรวม (Bulk PO):**
- เลขที่ PO
- วันที่
- ซัพพลายเออร์
- สถานะ (รอชำระเงิน, ชำระเงินแล้ว, จัดส่งแล้ว, เสร็จสมบูรณ์)
- รายการสินค้า (ชนิดน้ำมัน, จำนวน, ราคาต่อลิตร, รวม)
- ยอดรวมก่อน VAT
- VAT 8%
- รวมทั้งสิ้น
- ใบเสนอราคา (ไฟล์)
- ใบกำกับภาษี (ไฟล์)
- ใบเสร็จรับเงิน (ไฟล์)

**บันทึกการจัดส่ง (Delivery Records):**
- สาขา
- วันที่ส่ง
- เวลาส่ง
- รายการสินค้า (ชนิดน้ำมัน, ปริมาณ, มิเตอร์)
- รูปหลักฐานการรับน้ำมัน
- สถานะ (รอส่ง, รับแล้ว)
- ยืนยันแล้ว (ใช่/ไม่ใช่)

**กระจายต้นทุน (Cost Distribution):**
- สาขา
- ปริมาณและต้นทุนแยกตามชนิดน้ำมัน (Diesel, Gasohol 95, E20, Gasohol 91)
- รวมต้นทุน
- ใบเสร็จภายใน
- สถานะการชำระเงิน (รอชำระ, ชำระแล้ว)

**ฟังก์ชัน:**
- ดูคำขอจากสาขาทั้งหมด
- รวมยอดและสร้างใบสั่งซื้อรวม (Bulk PO)
- อัปโหลดใบเสนอราคา, ใบกำกับภาษี, ใบเสร็จรับเงิน
- บันทึกการชำระเงิน
- บันทึกการจัดส่ง (อัปโหลดรูปหลักฐาน)
- ยืนยันการรับน้ำมัน
- กระจายต้นทุนไปยังสาขาย่อย
- สร้างใบเสร็จภายในสำหรับแต่ละสาขา
- ดูประวัติการสั่งซื้อ (PO History) - ค้นหาและกรองข้อมูล

**Flow การทำงาน:**
1. สาขาย่อยแจ้งความต้องการน้ำมัน → สำนักงานใหญ่รวบรวมคำขอทั้งหมด
2. สำนักงานใหญ่รวมยอดและสร้างใบสั่งซื้อรวม (Bulk PO) → ส่งให้ซัพพลายเออร์
3. ซัพพลายเออร์ส่งใบเสนอราคา → อัปโหลดใบเสนอราคา
4. ชำระเงิน → อัปโหลดใบกำกับภาษีและใบเสร็จรับเงิน
5. บริษัทน้ำมันจัดส่ง → สาขาถ่ายหลักฐานการรับน้ำมัน → อัปโหลดรูป
6. สาขายืนยันการรับน้ำมัน
7. สำนักงานใหญ่กระจายต้นทุนไปยังสาขาย่อย → สร้างใบเสร็จภายใน
8. สาขาโอนเงินคืนสำนักงานใหญ่

---

### 11. รายงาน (Reports)

**หน้าที่:** รายงานยอดขายตามช่วงเวลา แยกตามชนิดน้ำมัน + พนักงาน และออกรายงานเอกสาร

**ข้อมูลที่แสดง:**
- ยอดขายวันนี้
- ยอดขายสัปดาห์นี้
- ยอดขายเดือนนี้ (เปรียบเทียบกับเดือนที่แล้ว)
- ยอดขายเดือนที่แล้ว
- ยอดขายแยกตามชนิดน้ำมัน (Gasohol 95, Diesel)
- ยอดขายแยกตามพนักงาน (จากสมุด Balance Petrel)
- เปรียบเทียบสาขา

**ฟังก์ชัน:**
- กรองข้อมูลตามสาขา, ช่วงเวลา (วันนี้, สัปดาห์นี้, เดือนนี้, ปีนี้)
- ส่งออกรายงาน PDF
- ออกรายงานเอกสาร (ใบรับสินค้า, ใบสั่งซื้อ, ใบเสร็จรับเงิน, สรุปสต็อก)
- พิมพ์ PDF ได้ทันที

**Flow การทำงาน:**
1. เลือกสาขาและช่วงเวลาที่ต้องการ
2. ระบบดึงข้อมูลและคำนวณสถิติ
3. แสดงรายงานในรูปแบบ Cards, Charts และ Tables
4. สามารถส่งออกรายงาน PDF หรือพิมพ์เอกสารได้

---

### 12. ตั้งค่า (Settings)

**หน้าที่:** จัดการการตั้งค่าสำหรับโมดูลบริหารจัดการปั๊มน้ำมัน (M1)

**ข้อมูลที่ตั้งค่า:**
- เส้นทาง Export จาก PTT BackOffice (เช่น \\\\server\\ptt_exports\\)
- นำเข้าอัตโนมัติ (เปิด/ปิด)
- เวลานำเข้าอัตโนมัติ (เช่น 06:00-08:00)
- การเชื่อมต่อโมดูล M6 (ส่งยอดขาย → ลงบัญชี) - เปิด/ปิด
- การเชื่อมต่อโมดูล M7 (แสดงในแดชบอร์ดรวม) - เปิด/ปิด

**ฟังก์ชัน:**
- ตั้งค่าเส้นทาง Export จาก PTT BackOffice
- ตั้งเวลานำเข้าอัตโนมัติ
- เปิด/ปิดการเชื่อมต่อโมดูล M6 และ M7
- บันทึกการตั้งค่า

**Flow การทำงาน:**
1. ตั้งค่าต่างๆ ตามต้องการ
2. บันทึกการตั้งค่า
3. ระบบจะใช้การตั้งค่าเหล่านี้ในการทำงานอัตโนมัติ

---

## Flow การทำงานหลักของระบบ

### Flow การซื้อเข้าน้ำมัน:
1. นำเข้า Excel จาก PTT BackOffice (PURCHASE_YYYYMMDD.xlsx) หรือกรอกด้วยมือ
2. ระบบประมวลผลและสร้างใบรับสินค้าอัตโนมัติ
3. บันทึกข้อมูลการซื้อเข้า
4. อัปเดตสต็อกน้ำมันอัตโนมัติ

### Flow การขายน้ำมัน:
1. นำเข้า Excel จาก PTT BackOffice (SALES_YYYYMMDD.xlsx)
2. ระบบประมวลผลยอดขายแยกตามช่องทางชำระเงิน 12 ช่องทาง
3. คำนวณยอดขายรวมและแยกตามช่องทาง
4. อัปเดตสต็อกน้ำมันอัตโนมัติ

### Flow การสั่งซื้อน้ำมัน (Centralized):
1. สาขาย่อยแจ้งความต้องการน้ำมัน
2. สำนักงานใหญ่รวบรวมคำขอทั้งหมด
3. รวมยอดและสร้างใบสั่งซื้อรวม (Bulk PO)
4. ส่งให้ซัพพลายเออร์ → ได้ใบเสนอราคา
5. ชำระเงิน → ได้ใบกำกับภาษี/ใบเสร็จรับเงิน
6. บริษัทน้ำมันจัดส่ง → สาขาถ่ายหลักฐานการรับน้ำมัน
7. สาขายืนยันการรับน้ำมัน
8. สำนักงานใหญ่กระจายต้นทุนไปยังสาขาย่อย → สร้างใบเสร็จภายใน
9. สาขาโอนเงินคืนสำนักงานใหญ่

### Flow การปรับราคา:
1. PTT โทมาแจ้งราคาใหม่ตอน 18:00
2. พนักงานบันทึกการแจ้งจาก PTT
3. พนักงานกรอกราคาใหม่สำหรับแต่ละชนิดน้ำมัน
4. ตั้งเวลาเปลี่ยนราคา (จะเปลี่ยนอัตโนมัติตอน 05:00)
5. ระบบเปลี่ยนราคาอัตโนมัติเมื่อถึงเวลา 05:00
6. บันทึกประวัติการปรับราคา

### Flow Meter & Dip Reading:
1. บันทึกมิเตอร์หัวจ่ายและ Dip ถังทุกวัน
2. ระบบคำนวณยอดขาย = มิเตอร์ปัจจุบัน - มิเตอร์ก่อนหน้า
3. ระบบคำนวณ Loss/Gain = ยอดขาย - (Dip ก่อนหน้า - Dip ปัจจุบัน)
4. ถ้า Loss/Gain เกิน 0.5% → แจ้งเตือน

### Flow การใช้คูปอง:
1. เพิ่มสมาชิก → ออกคูปองให้สมาชิก
2. เมื่อใช้คูปอง → บันทึกยอดที่ใช้ → อัปเดตยอดคงเหลือ
3. ถ้าใช้หมดแล้ว → เปลี่ยนสถานะเป็น "ใช้แล้ว"
4. ถ้าคูปองใกล้หมดอายุ → แสดงในแท็บ "คูปองใกล้หมดอายุ"
5. สามารถต่ออายุคูปองได้ (เพิ่มอายุ 1 เดือน)

---

## ข้อมูลหลักที่ระบบจัดการ

### ชนิดน้ำมัน (8 ชนิด):
1. Premium Diesel
2. Premium Gasohol 95
3. Diesel
4. E85
5. E20
6. Gasohol 91
7. Gasohol 95

### ช่องทางชำระเงิน (12 ช่องทาง):
1. เงินสด
2. Master / VISA
3. KBANK-CARD
4. PTT Privilege Energy Card
5. Fleet Card
6. Top up Card
7. ttb Fill&GO+
8. BBL Fleet Card
9. Visa Local Card
10. QR / KPLUS / PROMPTPAY
11. คูปองสถานี
12. ลูกหนี้เงินเชื่อ

### สาขา (5 สาขา):
1. สำนักงานใหญ่
2. สาขา A
3. สาขา B
4. สาขา C
5. สาขา D

---

## การเชื่อมต่อกับโมดูลอื่น

### M6 (ระบบบัญชี):
- ส่งยอดขาย → ลงบัญชี (รายได้ 4110)
- เปิด/ปิดการเชื่อมต่อได้ใน Settings

### M7 (แดชบอร์ดรวม):
- แสดงข้อมูลในแดชบอร์ดรวม
- เปรียบเทียบกับโมดูลอื่น
- เปิด/ปิดการเชื่อมต่อได้ใน Settings

---

## การนำเข้าข้อมูล

ระบบรองรับการนำเข้าข้อมูลจาก PTT BackOffice ในรูปแบบ Excel:

- **PURCHASE_YYYYMMDD.xlsx** - ข้อมูลการซื้อเข้าน้ำมัน
- **SALES_YYYYMMDD.xlsx** - ข้อมูลยอดขาย
- **STOCK_YYYYMMDD.xlsx** - ข้อมูลสต็อกน้ำมัน
- **BALANCE_YYYYMMDD.xlsx** - ข้อมูลสมุด Balance Petrel
- **DIP_YYYYMMDD.xlsx** - ข้อมูลสมุดน้ำมันใต้ดิน (Dip Reading)

ระบบสามารถนำเข้าอัตโนมัติตามเวลาที่ตั้งไว้ (เช่น 06:00-08:00) หรือนำเข้าแบบ Manual

---

## หมายเหตุสำคัญ

1. **คูปองสถานี**: ใน M1 เป็นช่องทางการชำระเงินเท่านั้น (PaymentType = Coupon) ไม่มีการหักส่วนลด ยอดขายยังคงเต็มราคา (Full Price) ตามข้อมูลจาก PTT BackOffice

2. **Loss/Gain**: ระบบคำนวณ Loss/Gain อัตโนมัติจาก Meter & Dip Reading ถ้าเกิน 0.5% จะแจ้งเตือน (อาจเกิดจากรั่วไหล, ระเหย, ความคลาดเคลื่อน)

3. **การปรับราคา**: PTT แจ้งราคาใหม่ตอน 18:00 → พนักงานปรับราคาในระบบ → ราคาเปลี่ยนอัตโนมัติตอน 05:00

4. **การสั่งซื้อน้ำมัน**: ระบบใช้แบบ Centralized Ordering - รวบรวมคำขอจาก 5 สาขา → สั่งซื้อแบบ Bulk (ประหยัดต้นทุน) → จัดส่ง → กระจายต้นทุน

